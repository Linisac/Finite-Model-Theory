\setcounter{chapter}{2}
\chapter{More on Games}
%section 1-------------------------------------------------------------------------------------
\section{Second-Order Logic}
\begin{enumerate}[1.]
%
\item \header{Hint to Exercise 3.1.2} Argue as in 2.2.2, 2.2.4, and 2.2.6-8.
%
\end{enumerate}
%end of section 1-----------------------------------------------------------------------------


%section 2------------------------------------------------------------------------------------
\section{Infinitary Logic: The Logics $\inflog$ and $\dlog{\omega_1}$}
\begin{enumerate}[1.]
%
\item \header{Note on the Definition of $\inflog$} In the fourth clause $\Psi$ is a \emph{set} while $\inflog$ itself is a \emph{class}. In particular, we cannot obtain an ``$\inflog$-formula'' by taking the disjunction of all $\inflog$-formulas.

Also, the set $\free(\varphi)$ of free variables in $\varphi \in \inflog$ may not be finite, as opposed to first-order formulas.

Finally, we could have defined the \emph{quantifier rank} $\qr(\varphi)$ of a formula in $\inflog$ in the same way as in $\folog$. However, this may not be a finite number. For example, the sentence given in 3.2.1(a) that characterizes the class $\even\of{\tau}$.
%
\item \header{Subformulas of $\inflog$-Sentences Only Have Finitely Many Free Variables} In fact, one can show by induction on the formation of formulas that if $\varphi \in \inflog$ has infinitely many free variables, then any $\inflog$-formula having $\varphi$ as a subformula must also have infinitely many free variables.
%
\item \header{Note on 3.2.2} Observe from the proof that, in both parts (a) and (b), the equivalent formula $\psi(\vect{x})$ constructed does not contain more quantifiers than does $\varphi(\vect{x})$. A bound variable in $\psi(\vect{x})$ may occur bound or free in $\varphi(\vect{x})$, whereas a free variable in $\psi(\vect{x})$ must occur free in $\varphi(\vect{x})$ (see the definition of a variable occurring free in a formula).

On the other hand, in case $I_0$ is empty, we let $\psi \defas \forall x \neg x = x$.

Finally, part (b) can be generalized to any finite collection of finite structures.
%
\item \header{Note on 3.2.3} The disjunction (or conjunction) is actually \emph{at most countable}.

The proof can be done without assuming $\varphi(\vect{x})$ is a sentence since $\hint{\card{A} + 1}{\strct{A}, \vect{a}}$ characterizes $(\strct{A}, \vect{a})$ up to isomorphism: For any structure $\strct{B}$ and any tuple of elements $\vect{b} \in B$ such that $\strct{B} \satis \hint{\card{A} + 1}{\strct{A}, \vect{a}}[\vect{b}]$, the partial isomorphism $\vect{a} \mapsto \vect{b}$ can be extended to a (full) isomorphism $p: \strct{A} \isom \strct{B}$.

Also note that this proposition has a similar flavor to Theorem 2.2.11, and in case the quantifier rank of $\varphi(\vect{x})$ is finite, say $\leq m$, the formula
\[
\blor \sett{\hint{m}{\strct{A}, \vect{a}}}{\mathmode{\strct{A}} a structure, \mathmode{\vect{a} \in A}, and \mathmode{\strct{A} \satis \varphi[\vect{a}]}}
\]
used there is also equivalent to $\varphi(\vect{x})$: If there are a structure $\strct{A}$ and elements $\vect{a}$ in $A$ such that $\strct{A} \satis \varphi[\vect{a}]$ and $\strct{B} \satis \hint{m}{\strct{A}, \vect{a}}[\vect{b}]$, then $(\strct{A}, \vect{a})$ and $(\strct{B}, \vect{b})$ satisfy the same first-order formulas of quantifier rank $\leq m$ in the variables $\vect{x}$. By 3.2.2(b), a suitable formula $\psi(\vect{x}) \in \folog$ can be chosen so that it is equivalent to $\varphi(\vect{x})$ for $\strct{A}$ and $\strct{B}$; notice that $\qr(\psi) \leq m$ (see \refitem{Note on 3.2.3}). It follows that $\strct{B} \satis \varphi[\vect{b}]$.

However, when the quantifier rank of $\varphi(\vect{x})$ is infinite, we cannot use the above technique: The first-order formula $\psi(\vect{x})$ equivalent to $\varphi(\vect{x})$ yielded by 3.2.2(b) depends on both $\strct{A}$ and $\strct{B}$ and thus $\qr(\psi)$ may not be bounded (as opposed to $\qr(\psi)$ being bounded by $m$ in the previous case). Moreover, for small values of $m$ (compared to $\card{A}$), $\hint{m}{\strct{A}, \vect{a}}$ does not characterize $(\strct{A}, \vect{a})$ up to isomorphism; with $m = \card{A} + 1$, $\hint{m}{\strct{A}, \vect{a}}$ characterizes $(\strct{A}, \vect{a})$ up to isomorphism, and hence the formula given in this proposition.

On the other hand, using the trick employed in the proof of 2.1.2, one can easily see that $\varphi(\vect{x})$ is equivalent to a countable conjunction of first-order formulas:
\[
\bland \setm{\cardexactly{n} \lthen \blor\setm{\hint{\card{A} + 1}{\strct{A}, \vect{a}}(\vect{x})}{\card{A} = n, \vect{a} \in A, \strct{A} \satis \varphi[\vect{a}]}}{n \geq 1}.
\]
Note that in the above formula the disjunction in every conjunct is finite. An alternative way to obtain this is to first apply this proposition to $\neg\varphi$ to obtain a countable disjunction of first-order formulas and then negate the disjunction.
%
\item \header{Note on 3.2.4 and 3.2.6} (INCOMPLETE) First, a partial isomorphism is not required to be a finite mapping, i.e.\ its graph is not necessarily finite, cf.\ Definition 2.2.1. Therefore, in 3.2.4 the notation $\vect{a}e_1e_2\etc \mapsto \vect{b}f_1f_2\etc$ can be considered a partial isomorphism from $\strct{A}$ to $\strct{B}$ if $\vect{a}e_1\etc e_i \mapsto \vect{b}f_1\etc f_i \in \partisoms(\strct{A}, \strct{B})$ for all $i$. The condition for the duplicator winning the game $\game{\infty}(\strct{A}, \strct{B})$ may be restated with this new notation.

Next, for any vocabulary $\tau$ (recall that $\tau$ is finite) and any $\tau$-structures $\strct{A}, \strct{B}$ the following statements are equivalent:
\begin{enumerate}[(1)]
%%
\item $\strct{A}$ and $\strct{B}$ are \emph{elementarily equivalent} (written: $\strct{A} \equv \strct{B}$), i.e.\ $\strct{A}$ and $\strct{B}$ satisfy the same $\folog\of{\tau}$-sentences.
%%
\item $\strct{A}$ and $\strct{B}$ are \emph{finitely isomorphic} (written: $\strct{A} \isom_\fin \strct{B}$), i.e.\ there is an infinite sequence $\seq{I_j}{j \in \nat}$ that satisfies the properties \refitem{(a) - (c)} in Definition 2.3.1 except that ``$j < m$'' is replaced by ``$j \in \nat$'' in conditions \refitem{(b)} and \refitem{(c)}.
%%
\item For $j \in \nat$, the duplicator wins the game $\game{j}(\strct{A}, \strct{B})$.
%%
\item The duplicator wins the game $\fingame(\strct{A}, \strct{B})$ in which the spoiler begins the game by first choosing a natural number $j$ and then the game proceeds as $\game{j}(\strct{A}, \strct{B})$.
%%
\end{enumerate}
Using Corollary 2.3.4, we obtain a further equivalent statement:
\begin{enumerate}[(1)]
\setcounter{enumii}{4}
%%
\item $\strct{B} \satis \bland_{j \in \nat} \hint{j}{\strct{A}}$,
%%
\end{enumerate}
(note that the sentence $\bland_{j \in \nat} \hint{j}{\strct{A}}$ is in $\dlog{\omega_1}$) and, using Lemma 2.2.4(b), yet another equivalent statement, in parallel to Corollary 2.3.4(ii):
\begin{enumerate}[(1)]
\setcounter{enumii}{5}
%%
\item $\seq{\winpos{j}(\strct{A}, \strct{B})}{j \in \nat} : \strct{A} \isom_\fin \strct{B}$.
%%
\end{enumerate}
It follows that, by Proposition 2.1.1, if $\strct{A}$ and $\strct{B}$ are both finite and if $\strct{A} \isom_\fin \strct{B}$, then $\strct{A} \isom \strct{B}$.

The above should be easy to generalize so that we have $(\strct{A}, \vect{a}), (\strct{B}, \vect{b})$ in place of $\strct{A}, \strct{B}$, as well as the additional conditions $\vect{a} \mapsto \vect{b} \in I_j$ in \refitem{(2)} and $\vect{a} \mapsto \vect{b} \in \winpos{j}(\strct{A}, \strct{B})$ in \refitem{(6)}.\footnote{For example, we can regard $(\strct{A}, \vect{a})$ and $(\strct{B}, \vect{b})$ as the $\tau \union \sete{\vect{c}}$-expansion of $\strct{A}$ and of $\strct{B}$ in which $\vect{c}$ is interpreted by $\vect{a}$ and $\vect{b}$, respectively.} In particular, we have that $(\strct{A}, \vect{a}) \equv (\strct{B}, \vect{b})$ if and only if $(\strct{A}, \vect{b}) \isom_\fin (\strct{B}, \vect{b})$.

Notice that, however, the condition that the duplicator wins $\fingame(\strct{A}, \vect{a}, \strct{B}, \vect{b})$ generally does not imply that he wins $\game{\infty}(\strct{A}, \vect{a}, \strct{B}, \vect{b})$ although the converse is obviously true. See Exercise XII.1.10 in \cite{EFT} to give an example of two finitely isomorphic structures that are not partially isomorphic; the same exercise problem also asks to give an example of two partially isomorphic structures that are not isomorphic.

On the other hand, consider the $\emptyvoc$-structures (i.e.\ sets) $\strct{A}, \strct{B}$ that consist of the domains $A = \sete{0, 1}, B = \sete{0, 1, 2}$, respectively. Then it follows that $\strct{A} \isom_2 \strct{B}$ but not $\strct{A} \isom_\fin \strct{B}$ (since not $\strct{A} \isom_3 \strct{B}$).

To summarize, we have the successively weaker notions (where \refitem{(1)} clearly implies \refitem{(2)}):
\begin{enumerate}[(1)]
%%
\item $\strct{A} \isom \strct{B}$
%%
\item $\strct{A} \isom_\partially \strct{B}$
%%
\item $\strct{A} \isom_\fin \strct{B}$
%%
\item $\strct{A} \isom_j \strct{B}$ in which $j \in \nat$.
%%
\end{enumerate}

\begin{remark}
For more details see Chapter XII in \cite{EFT}.
\end{remark}

Finally, there are some facts about the set $\winpos{\infty}(\strct{A}, \strct{B})$ of winning positions: \begin{enumerate}[(a)]
%%
\item $\winpos{\infty}(\strct{A}, \strct{B}) \subset \partisoms(\strct{A}, \strct{B})$.
%%
\item $\winpos{\infty}(\strct{A}, \strct{B}) \neq \emptyset$ if and only if $\winpos{\infty}(\strct{A}, \strct{B}): \strct{A} \isom_\partially \strct{B}$.
%%
\item If $I: \strct{A} \isom_\partially \strct{B}$ then $I \subseteq \winpos{\infty}(\strct{A}, \strct{B})$.
%%
\end{enumerate}

\begin{remark}
Note that there are cases where a partial isomorphism, finite or infinite, from $\strct{A}$ to $\strct{B}$ in which $\strct{A}$ and $\strct{B}$ are partially isomorphic, cannot be extended:
\begin{enumerate}[(1)]
%%
\item Consider relational $\tau = \sete{E}$, $E$ binary, and $A = \sete{a_1, a_2}, \intpr{E}{A} = \sete{(a_1, a_2)}, B = \sete{b_1, b_2}, \intpr{E}{B} = \sete{(b_1, b_2)}$. Note that $\strct{A}$ and $\strct{B}$ are (partially) isomorphic digraphs. The partial isomorphism $p = \sete{(a_1, b_2)}$ cannot be extended.
%%
\item Consider $\tau = \emptyset$, $\strct{A} = \rat$, and $\strct{B} = \real$. Then $\strct{A}$ and $\strct{B}$ are partially isomorphic, and the partial isomorphism $p$ that is the identity cannot be extended.
%%
\end{enumerate}
The proper inclusion in (a), even when $\winpos{\infty}(\strct{A}, \strct{B}) \neq \emptyset$, is justified by case (1); in addition, winning positions are assumed to be finite maps by definition.
\end{remark}
%
\item \header{Note on Theorem 3.2.7} In the direction from \refitem{(iii)} to \refitem{(iv)} of the proof,
\begin{itemize}
%%
\item transfinite induction is needed because the quantifier rank of an $\inflog$-formula may not be in $\omega$;
%%
\item the length $s$ of tuples in \refitem{($\ast$)} is better to be replaced by say $r$, since $s$ is fixed for the length of $\vect{a}$ and $\vect{b}$ whereas the tuples in \refitem{($\ast$)} may have different lengths.
%%
\end{itemize}
Also, there is a typo in the direction from \refitem{(iv)} to \refitem{(iii)}: ``$a \in I$'' should change to ``$a \in A$''.

\begin{remark}
This theorem does not seem to have a corresponding statement \refitem{(iv)} to that of Theorem 2.3.3. As noted in \textbf{Note on the Definition of $\inflog$}, we cannot take a single $\inflog$-sentence $\varphi_\strct{A}$ that is the conjunction of all $\inflog$-sentences $\psi$ satisfied by $\strct{A}$ (such a \emph{sentence} $\varphi_\strct{A}$ does not exist because there are too many $\psi$ to fit into a \emph{set}) so that for every $\strct{B}$, $\strct{B} \satis \varphi_\strct{A}$ if and only if $\strct{A}$ and $\strct{B}$ satisfy the same $\inflog$-sentences.

(INCOMPLETE) Nevertheless, we have for every $\strct{A}$ and every $\strct{B}$,
\begin{center}
\begin{tabular}{ll}
\   & $\strct{A}$ and $\strct{B}$ satisfy the same $\inflog$-sentences \cr
iff & for every cardinal $\kappa$, $\strct{A}$ and $\strct{B}$ satisfy the same $\dlog{\kappa}$-sentences \cr
iff & for every cardinal $\kappa$, $\strct{B} \satis \varphi_{\strct{A}, \kappa}$, \cr
\end{tabular}
\end{center}
where $\varphi_{\strct{A}, \kappa}$ is an $\inflog$-sentence that characterizes $\dlog{\kappa}$-equivalence to $\strct{A}$. The sentence $\varphi_{\strct{A}, \kappa}$ is expected to be in $\dlog{\kappa'}$ in which $\kappa'$ is the immediate larger cardinal than $\kappa$. For example, in the case $\kappa = \omega$, the $\dlog{\omega}$-equivalence (i.e.\ $\folog$-equivalence, or elementary equivalence) to $\strct{A}$ is characterized by an $\dlog{\omega_1}$-sentence. See \textbf{Note on 3.2.4 and 3.2.6}. The above discussion yields that $\bland_\kappa \varphi_{\strct{A}, \kappa}$ does not exist (in $\inflog$).
\end{remark}
%
\item \header{Note on \refitem{(iii)} of 3.2.8} The equivalence between \refitem{(iii)} of 3.2.7 for $s = 0$ and that of 3.2.8 can be justified via 2.3.2 (cf.\ 2.3.4).
%
\item \header{Note on 3.2.7 and 3.2.8 Collectively} Based on the observation made in \textbf{Note on 3.2.4 and 3.2.6}, I have
\begin{conjecture}
Let $\strct{A}, \strct{B}$ be two structures and $\kappa, \kappa'$ be two cardinalities such that $\kappa'$ is the immediate greater cardinality than $\kappa$. Then there is an $\dlog{\kappa'}$-sentence $\varphi_\strct{A}$ such that
\begin{center}
$\strct{A} \equv^{\dlog{\kappa}} \strct{B}$ if and only if $\strct{B} \satis \varphi_\strct{A}$.
\end{center}
\end{conjecture}
This enhances 3.2.8. Similarly, 3.2.7 can be enhanced.
%
\item \header{Note on 3.2.11}
\begin{enumerate}[(1)]
%%
\item For $r \geq 0$, the set $\Delta_{r + 1}$ is finite.
%%
\item A $2$-extension axiom has the form
\[
\forall v_1 \exists v_2 (v_1 \neq v_2 \land \bland_{\varphi \in \Phi} \varphi \land \bland_{\varphi \in \cmpl{\Phi}} \neg\varphi).
\]
%%
\item In fact, the condition ``$\hint{0}{\strct{A}, \vect{a}} = \hint{0}{\strct{B}, \vect{b}}$'' in the definition of the set $I$ of maps is equivalent to ``$\vect{a} \mapsto \vect{b}$ is a partial isomorphism from $\strct{A}$ to $\strct{B}$'', by 2.2.5 and parts (b) and (c) of 2.2.7, whether or not $\tau$ is relational; in other words, $I = \partisoms(\strct{A}, \strct{B})$.

Moreover, by the assumption that $\tau$ is relational (containing no constants), the empty map $\emptymap$ is a partial isomorphism from $\strct{A}$ to $\strct{B}$ (see 2.2.2(a)) and coincides with $\emptyseq \mapsto \emptyseq$; it follows that $\hint{0}{\strct{A}, \emptyseq} = \hint{0}{\strct{B}, \emptyseq}$ and is equal to $\tr \land \neg\fls$ (cf.\ Part B in Chapter 1).

In case $\tau$ is not relational, however, the empty map $\emptymap$ and $\emptyseq \mapsto \emptyseq$ are not identical. If in addition $\tau$ contains two constants $c_1, c_2$ so that $\intpr{c_1}{\strct{A}} = \intpr{c_2}{\strct{A}}$ but $\intpr{c_1}{\strct{B}} \neq \intpr{c_2}{\strct{B}}$, then $\emptyseq \mapsto \emptyseq$ is not even a partial isomorphism and $I = \emptyset$.
%%
\item In the proof $I$ has the forth property, note that
\[
\begin{array}{lll}
\ & \hint{0}{\strct{B}, \vect{b}b_{r + 1}} & \cr
= & \hint{0}{\strct{B}, \vect{b}} \land \bland\limits_{1 \leq i \leq r} \neg v_i = v_{r + 1} \land \bland\limits_{\varphi \in \Phi} \varphi \land \bland\limits_{\varphi \in \cmpl{\Phi}} \neg\varphi & \text{(since \mathmode{(\strct{B}, \vect{b}b_{r + 1}) \satis \Phi})} \cr
= & \hint{0}{\strct{A}, \vect{a}} \land \bland\limits_{1 \leq i \leq r} \neg v_i = v_{r + 1}\land \bland\limits_{\varphi \in \Phi} \varphi \land \bland\limits_{\varphi \in \cmpl{\Phi}} \neg\varphi & \text{(since \mathmode{\vect{a} \mapsto \vect{b} \in I})} \cr
= & \hint{0}{\strct{A}, \vect{a}a_{r + 1}} & \text{(since \mathmode{(\strct{A}, \vect{a}a_{r + 1}) \satis \Phi})}. \cr
\end{array}
\]
%%
\item In the construction of a countable model $\strct{A}$ of $\randstrtheory$ by means of the infinite sequence of $\strct{A}_n$'s, note that $r \leq n + 1$ is implied by the requirement that $\vect{m}$ consists of distinct entries and all entries are not greater than $n$.

However, this construction procedure does not specify, given $\strct{A}_n$ and $\alpha_n = (\vect{m}, \extaxm)$, the relationship in $\strct{A}_{n + 1}$ between the element $n + 1$ and any other tuple than $\vect{m}$ in terms of the interpretation of relation symbols $R \in \tau$. Thus, the relationship can be arbitrarily defined. (Nevertheless, this freedom in defining the relationship is somewhat restricted in the construction procedure for a countable model of $\randstrtheory(\varphi_0)$ mentioned before (3) leading to Theorem 4.2.3.)
%%
\item If $\tau$ only contains unary relation symbols, say $\tau = \sete{R_1, \etc, R_m}$. Then for every model $\strct{A}$ of $\randstrtheory$, the the sets $\intpr{R_1}{\strct{A}}, \etc, \intpr{R_m}{\strct{A}}$ yield a partition of the universe $A$ of $\strct{A}$ into $2^m$ subsets, each of which consists of infinitely many elements.

\begin{remark}
The results given in textbook remain valid in this case.
\end{remark}
%%
\end{enumerate}
%
\item \header{Hint to Exercise 3.2.13} Note that $x_1$ is the first element of the tuple $\vect{x}$ and therefore the sentence $\forall \vect{x} (\existexactly{1}x F\vect{x}x \land F\vect{x}x_1)$ formalizes the idea that $F$ is a (total) function that projects a tuple of parameter(s) onto its first parameter.
%
\item \header{Solution to Exercise 3.2.14} Without loss of generality let us assume that $A$ is finite and that $\card{A} = \min\sete{\card{A}, \card{B}}$. We also assume, for simplicity, that partial isomorphisms from $\strct{A}$ to $\strct{B}$ take the form $\vect{a} \mapsto \vect{b}$ (having finite domains and ranges) in which $\vect{a}$ and $\vect{b}$ consist of distinct elements.
\newpar
Now we distinguish three cases:
\begin{enumerate}[(1)]
%%
\item $\strct{A} \isom \strct{B}$.
%%
\item For any $m \in \nat$, $\vect{a} \in A$ and $\vect{b} \in B$, not $(\strct{A}, \vect{a}) \isom_m (\strct{B}, \vect{b})$.
%%
\item Not $\strct{A} \isom \strct{B}$, and there are $m \in \nat$, $\vect{a} \in A$ and $\vect{b} \in B$ such that $(\strct{A}, \vect{a}) \isom_m (\strct{B}, \vect{b})$.
%%
\end{enumerate}
In case (1), we have that $\winpos{\infty}(\strct{A}, \strct{B}) = \winpos{0}(\strct{A}, \strct{B}) = \partisoms(\strct{A}, \strct{B}) \neq \emptyset$, which contains all isomorphisms from $\strct{A}$ to $\strct{B}$. Thus, set $m_0 \defas 0$.
\newpar
In case (2), it follows in particular that for any $\vect{a} \in A$ and $\vect{b} \in B$, not $(\strct{A}, \vect{a}) \isom_0 (\strct{B}, \vect{b})$. Hence $\winpos{\infty}(\strct{A}, \strct{B}) = \winpos{0}(\strct{A}, \strct{B}) = \partisoms(\strct{A}, \strct{B}) = \emptyset$. Thus, set $m_0 \defas 0$.
\newpar
In case (3), we may assume, with no loss of generality, that $m \leq \card{A}$ and for any $\vect{a'} \in A$ and $\vect{b'} \in B$, not $(\strct{A}, \vect{a'}) \isom_{m + 1} (\strct{B}, \vect{b'})$. So we have
\[
\winpos{0}(\strct{A}, \strct{B}) \neq \emptyset, \etc, \winpos{m}(\strct{A}, \strct{B}) \neq \emptyset
\]
(cf.\ 2.2.4(c)) but
\[
\winpos{\infty}(\strct{A}, \strct{B}) = \winpos{m + 1}(\strct{A}, \strct{B}) = \emptyset.
\]
It then suffices to show that for $j < m$, 
\[
\winpos{j}(\strct{A}, \strct{B}) \neq \winpos{j + 1}(\strct{A}, \strct{B}).
\]
In fact, in any $\winpos{j + 1}(\strct{A}, \strct{B})$ there must be a maximal -- in the sense of set inclusion -- partial isomorphism $q$ (i.e.\ there is $q \in \winpos{j + 1}(\strct{A}, \strct{B})$ such that there is no $q' \in \winpos{j + 1}(\strct{A}, \strct{B})$ with $q' \supset q$) for which there is an $a \in A$ with $a \notin \dm(q)$, since $A$ is finite and $\strct{A}$ and $\strct{B}$ are not isomorphic (also cf.\ the proof of 2.2.3(b)). By 2.2.4(b) there is a $p \in \winpos{j}(\strct{A}, \strct{B})$ with $\dm(p) = \dm(q) \union \sete{a}$; note that $p \notin \winpos{j + 1}(\strct{A}, \strct{B})$ because $p \supset q$ and $q$ is maximal in $\winpos{j + 1}(\strct{A}, \strct{B})$. Thus, set $m_0 \defas m + 1$.
\begin{remark}
By definition (cf.\ 3.2.4) and 2.2.4(c), we immediately have
\[
\winpos{0}(\strct{A}, \strct{B}) \supseteq \etc \supseteq \winpos{m}(\strct{A}, \strct{B}) \supseteq \etc \supseteq \winpos{\infty}(\strct{A}, \strct{B}).
\]
\end{remark}
%
\end{enumerate}
%end of section 2-----------------------------------------------------------------------------


%section 3------------------------------------------------------------------------------------
\section{The Logics $\folog[s]$ and $\inflog[s]$}
\begin{enumerate}[1.]
%
\item \header{Note on 3.3.3} By the same argument, one can derive from 3.2.2(b) the statement: \emph{If $\strct{A}$ and $\strct{B}$ are finite then $\strct{A} \equv \strct{B}$ implies $\strct{A} \equv^{\inflog} \strct{B}$.}

Alternatively, one can derive it using the fact that finite structures can be characterized in $\folog$ up to isomorphism (cf.~2.1.1).
%
\item \header{Note on Pebble Games $\game[s]{m}(\strct{A}, \vect{a}, \strct{B}, \vect{b})$} They are different from the usual Ehrenfeucht-Fra\"iss\'e games $\game{m}(\strct{A}, \vect{a}, \strct{B}, \vect{b})$ in that the number of pebbles are fixed ($s$ for each of $\strct{A}$ and $\strct{B}$ here) and the pebbles are on or off (denoted by $\off$) the board; once a pebble is placed onto the board, it is never put off the board. That is to say, the rounds of pebble games consist of both players putting the pebbles onto the board (extensions) and moving them around on the board (relocations).

Also note that if $s < t$ and if the spoiler wins $\game[s]{m}(\strct{A}, \vect{a}, \strct{B}, \vect{b})$, then he wins $\game[t]{m}(\strct{A}, \vect{a}, \strct{B}, \vect{b})$.
%
\item \header{Note on 3.3.6}
\begin{enumerate}[(a)]
%%
\item To avoid confusion, the last statement should be ``for arbitrary \emph{$\emptyvoc$-structures} $\strct{A}$ and $\strct{B}$, the duplicator wins $\game[s]{\infty}(\strct{A}, \strct{B})$ iff he wins $\game[s]{s}(\strct{A}, \strct{B})$.'' This is not true for arbitrary $\tau$, however, as can be seen in the example given in the next part.
%%
\item Let $l \geq 3$. Then the spoiler wins $\game[3]{m}(\strct{G}_l, \strct{G}_l \dunion \strct{G}_l)$ if and only if $m > \frac{l + 1}{2}$, and his winning strategy can be transformed into a $\folog\of{\sete{E}}$-formula of quantifier rank $m$ to distinguish $\strct{G}_l$ and $\strct{G}_l \dunion \strct{G}_l$ (cf.\ 2.3.16).
%%
\end{enumerate}
%
\item \header{Hint to Exercise 3.3.7} Observe the following equivalence that will be useful (a) and (c), where the structures $\strct{A}$ and $\strct{B}$ are both finite:
\begin{center}
\begin{tabular}{lll}
\   & the duplicator wins the game $\game[s]{\infty}(\strct{A}, \strct{B})$ & \cr
iff & $\strct{A} \equv^{\inflog[s]} \strct{B}$ & (by \refitem{3.3.5(d)}) \cr
iff & $\strct{A} \equv^s \strct{B}$ & (by 3.3.3). \cr
\end{tabular}
\end{center}
\begin{enumerate}[(a)]
%%
\item For the `if' direction, by the above observation it suffices to show that $\strct{A}$ is characterized by a $\folog[2]$-sentence up to isomorphism. Assume that $A = \sete{a_0, \etc, a_k}$, where $a_0 \mathrel{\intpr{<}{A}} \etc \mathrel{\intpr{<}{A}} a_k$.
Then take the conjunction of the following (where $\psi'_n$ is as in Examples 3.3.1):
\begin{itemize}
%%%
\item The size of $A$ ($\card{A} = k + 1$):
\[
\exists x \psi'_k \land \forall x \neg\psi'_{k + 1}.
\]
%%%
\item The interpretation of $c \in \tau$ in $\strct{A}$ ($\intpr{c}{\strct{A}} = a_i$):
\[
\forall x (x = c \liff \psi'_i).
\]
%%%
\item The interpretation $\intpr{P}{\strct{A}}$ of unary $P \in \tau$ in $\strct{A}$:
\[
\forall x (Px \liff \blor \setm{\psi'_i}{a_i \in \intpr{P}{\strct{A}}}).
\]
%%%
\item The interpretation $\intpr{R}{\strct{A}}$ of binary $R \in \tau$ in $\strct{A}$:
\[
\forall x \forall y (Rxy \liff \blor \setm{\psi'_i \land \psi'_j\begin{perm}{c} yx \cr xy \end{perm}}{(a_i, a_j) \in \intpr{R}{\strct{A}}}).
\]
%%%
\end{itemize}
%%
\item By 3.3.5(c), this is equivalent to showing: $\strct{A} \equv^s_m \strct{B}$ iff $\strct{A}$ and $\strct{B}$ satisfy the same $\folog[s]$-sentences $\varphi$ with $t \defas \qr(\varphi) \leq m$ such that
\[
\varphi = \left\lbrace
\begin{array}{lll}
Q_1v_1 \psi & \mbox{with \mathmode{\psi \in \folog[1]} and \mathmode{\qr(\psi) = 0}} & \mbox{if \mathmode{t = 1}} \cr
Q_1v_1 \etc Q_tv_t(\psi \land \bland\limits_{1 \leq i < j \leq t} \neg v_i = v_j) & \mbox{with \mathmode{\psi \in \folog[t]} and \mathmode{\qr(\psi) = 0}} & \mbox{if \mathmode{1 < t \leq s}} \cr
Q_1v_1 \etc Q_sv_s(\psi \land \bland\limits_{1 \leq i < j \leq s} \neg v_i = v_j) & \mbox{with \mathmode{\psi \in \folog[s]} and \mathmode{\qr(\psi) = t - s}} & \mbox{if \mathmode{t > s}} \cr
\end{array}\right.
\]
where each $Q_k \in \sete{\exists, \forall}$.
%For the `only if' direction, note that the partial isomorphisms of size $s$ from $\strct{A}$ to $\strct{B}$ resulted from all possible rounds of the game $\game[s]{m}(\strct{A}, \strct{B})$ with the additional condition after $s$ moves provide a winning strategy for the duplicator in the same game without that condition.
%%
\item Suppose that $\tau$ is relational and all its relation symbols are of arity $\leq s$,\footnote{Note that $s \geq 1$ is implicitly assumed, see Part A in Chapter 1.} that $\card{A} = \card{B} \leq s + 1$ and that the duplicator wins $\game[s]{\infty}(\strct{A}, \strct{B})$, then our goal is to show $\strct{A} \isom \strct{B}$. We further assume that $\tau \neq \emptyset$: If $\tau = \emptyset$, then obviously $\strct{A} \isom \strct{B}$ given $\card{A} = \card{B}$.

By the earlier observation, it suffices to give a first-order sentence $\varphi_\strct{A} \defas \psi_{= \card{A}} \land \psi_{\intpr{R}{\strct{A}}}$ that characterizes $\strct{A}$ up to isomorphism, where $\psi_{= \card{A}} \in \folog[\card{A} + 1]\of{\emptyset}$ expresses the cardinality of $\strct{A}$ and $\psi_{\intpr{R}{\strct{A}}} \in \folog[s]\of{\tau}$ expresses the relations $\intpr{R}{\strct{A}}$. The sentence $\psi_{= \card{A}}$ is easy, as can be found at the end of Part B in Chapter 1. So let us move on to define $\psi_{\intpr{R}{\strct{A}}}$ below, and the set of atomic formulas
\[
\Theta_n \defas \sett{\theta}{\mathmode{\theta} has the form \mathmode{Rx_1 \etc x_k}, \mathmode{x = y} and the variables are among \mathmode{v_1, \etc, v_n}}
\]
employed in the proof of 2.1.1 will be useful here (note that there are no formulas of the form $c = x$ in $\Theta_n$ as $\tau$ is assumed to be relational).

The sentence $\psi_{\intpr{R}{\strct{A}}}$ depends on whether $\card{A} \leq s$ or $\card{A} = s + 1$. The case $\card{A} \leq s$ is simple: If $\card{A} = n \leq s$, say $A = \sete{a_1, \etc, a_n}$, then we choose
\[
\psi_{\intpr{R}{\strct{A}}} \defas \exists v_1 \etc \exists v_n (\bland\setm{\theta}{\theta \in \Theta_n, \strct{A} \satis \theta[\vect{a}]} \land \bland\setm{\neg\theta}{\theta \in \Theta_n, \strct{A} \satis \neg\theta[\vect{a}]})
\]
in which $\vect{a}$ denotes $a_1 \etc a_n$.

Now let us turn to the case $\card{A} = s + 1$. Let $A = \sete{a_1, \etc, a_{s + 1}}$. We only have $s$ distinct variables $v_1, \etc, v_s$ available to describe the relations $\intpr{R}{\strct{A}}$. This does not present a problem, however, because we can ``reuse'' these variables in our definition of $\psi_{\intpr{R}{\strct{A}}}$. To be more specific, we describe the relations and inequalities
\begin{enumerate}[(1)]
%%
\item among $a_1, \etc, a_s$ first, where $v_1, \etc, v_s$ are intended to represent $a_1, \etc, a_s$ respectively, and then
%%
\item among $a_1, \etc, a_{s + 1}$ excluding $a_i$, where $v_1, \etc, v_s$ are intended to represent $a_1, \etc, a_s$ in this order, respectively, except that $v_i$ stands for $a_{s + 1}$ but not $a_i$, for each $1 \leq i \leq s$.
%%
\end{enumerate}
In part (2), we will reuse the variables via quantification.

For brevity, let
\[
\vect{a}_i \defas
\begin{cases}
a_1, \etc, a_s & \mbox{if \mathmode{i = 0}} \cr
a_1, \etc, a_{i - 1}, a_{s + 1}, a_{i + 1}, \etc, a_s & \mbox{if \mathmode{1 \leq i \leq s}} \cr
\end{cases}
\]
($\vect{a}_1 = a_{s + 1}, a_2, \etc, a_s$ and $\vect{a}_s = a_1, \etc, a_{s - 1}, a_{s + 1}$). The desired sentence is thus
\[
\psi_{\intpr{R}{\strct{A}}} \defas \exists v_1 \etc \exists v_s \bland^s_{i = 0} \psi_i
\]
in which the formula
\[
\psi_0 \defas \bland \setm{\theta}{\theta \in \Theta_s, \strct{A} \satis \theta[\vect{a}_0]} \land \bland \setm{\neg\theta}{\theta \in \Theta_s, \strct{A} \satis \neg\theta[\vect{a}_0]}
\]
corresponds to (1) and the formulas, for $1 \leq i \leq s$,
\[
\psi_i \defas
\begin{cases}
\forall v_i ((\bland\limits_{1 \leq j \leq s, j \neq i} \neg v_i = v_j) \lthen \psi_0) & \text{if \mathmode{\strct{A} \satis \psi_0[\vect{a}_i]}}\cr
\exists v_i (\bland \setm{\theta}{\theta \in \Theta_s, \strct{A} \satis \theta[\vect{a}_i]} \land \bland \setm{\neg\theta}{\theta \in \Theta_s, \strct{A} \satis \neg\theta[\vect{a}_i]}) & \text{otherwise}\cr
\end{cases}
\]
altogether correspond to (2).

\begin{remark}
Observe that $\qr(\psi_{\intpr{R}{\strct{A}}}) = \card{A}$, we obtain a stronger version of the result: \emph{Suppose that $\tau$ is relational and all its relation symbol are of arity $\leq s$. If $\card{A} = \card{B} = n \leq s + 1$ and if the duplicator wins $\game[s]{n}(\strct{A}, \strct{B})$, then $\strct{A} \isom \strct{B}$.}
\end{remark}
%%
\end{enumerate}
%
\item \header{Note on the $s$-$m$-Isomorphism Type $\ityp[s]{m}{\strct{A}, \vect{a}}$} Unlike $\game{m}(\strct{A}, \vect{a}, \strct{B}, \vect{b})$, the game $\game[s]{m}(\strct{A}, \vect{a}, \strct{B}, \vect{b})$ consists of moves that \emph{substitute} pairs of elements in partial isomorphisms rather than \emph{extend} partial isomorphisms with pairs of elements. This is reflected in the definition of $\ityp{m + 1}{\strct{A}, \vect{a}}$:
\begin{enumerate}[(1)]
%%
\item The running conjunction $\bland\limits_{1 \leq i \leq s}$ specifies the valid positions for substitution, and the formula $\ityp{m}{\strct{A}, \vect{a}\sbst{a}{i}}$ specifies that $\vect{a}\sbst{a}{i} \mapsto \vect{b}\sbst{b}{i}$ is an $s$-partial isomorphism whose constituent pairs can be substituted $m$ times (given the premise $\strct{B} \satis \ityp{m}{\strct{A}, \vect{a}\sbst{a}{i}}[\vect{b}\sbst{b}{i}]$).
%%
\item The conjunct $\ityp{0}{\strct{A}, \vect{a}}$ is necessary because it describes the relation among the elements in $\vect{a}$ so that if $\strct{B} \satis \ityp{0}{\strct{A}, \vect{a}}[\vect{b}]$ then $\vect{a} \mapsto \vect{b}$ is an $s$-partial isomorphism from $\strct{A}$ to $\strct{B}$ (and vice versa), whereas the other conjunct $\bland\limits_{1 \leq i \leq s}(\bland\limits_{a \in A} \exists v_i \ityp{m}{\strct{A}, \vect{a}\sbst{a}{i}} \land \forall v_i \blor\limits_{a \in A} \ityp{m}{\strct{A}, \vect{a}\sbst{a}{i}})$ does not have this effect. In fact, we have
\[
\consq \hint{m + 1}{\strct{A}, \vect{a}} \lthen \hint{0}{\strct{A}, \vect{a}}
\]
(cf.\ 2.2.4(c)) but
\begin{center}
not $\consq \bland\limits_{1 \leq i \leq s}(\bland\limits_{a \in A} \exists v_i \ityp{m}{\strct{A}, \vect{a}\sbst{a}{i}} \land \forall v_i \blor\limits_{a \in A} \ityp{m}{\strct{A}, \vect{a}\sbst{a}{i}}) \lthen \ityp{0}{\strct{A}, \vect{a}}$
\end{center}
(for $\vect{a} \mapsto \vect{b}$ there may be an $a' \neq a_i$ or a $b' \neq b_i$ such that $\vect{a}\sbst{a'}{i} \mapsto \vect{b}$ or $\vect{a} \mapsto \vect{b}\sbst{b'}{i}$ is an $s$-partial isomorphism).

Note that the conjunct $\ityp{0}{\strct{A}, \vect{a}}$ is redundant and is implied by the other conjunct only when $\vect{a} = \off \etc \off$.
%%
\end{enumerate}
%
\item \header{Note on 3.3.9 and of 3.3.10} In 3.3.9, part (a) gives
\begin{center}
\begin{tabular}{ll}
\   & $(\strct{A}, \vect{a}) \equv^s (\strct{B}, \vect{b})$ \cr
iff & for every $m \in \nat$, $(\strct{A}, \vect{a}) \equv^s_m (\strct{B}, \vect{b})$ \cr
iff & for every $m \in \nat$, $\strct{B} \satis \ityp[s]{m}{\strct{A}, \vect{a}}[\vect{b}]$ \cr
iff & $\strct{B} \satis (\bland\limits_{m \in \nat} \ityp[s]{m}{\strct{A}, \vect{a}})[\vect{b}]$. \cr
\end{tabular}
\end{center}
Likewise for 3.3.10.

On the other hand, part (b) of 3.3.9 (or 3.3.10) lacks the corresponding statement to \refitem{(iv)} of part (a), since there is no single formula (or sentence, respectively) in $\inflog[s]$ that characterizes the $\inflog[s]$-equivalence to $(\strct{A}, \vect{a})$ (or $\strct{A}$, respectively), see \textbf{Remark} in \textbf{Note on Theorem 3.2.7}.
%
\item \header{Note on 3.3.11} As in 3.2.11, the underlying vocabulary $\tau$ is relational and the results remain valid when $\tau$ contains only unary relation symbols.

The first statement that \emph{every model of $\conjextaxm{s}$ has at least $s$ elements} can be proved by induction on $s$, using the fact that $\conjextaxm{s + 1}$ is the conjunction of all $(s + 1)$-extension axioms with $\conjextaxm{s}$.

To prove the second statement that \emph{every two models $\strct{A}$ and $\strct{B}$ of $\epsilon_s$ are $s$-partially isomorphic}, consider the set
\[
I \defas \sett{\vect{a} \mapsto \vect{b}}{\mathmode{\vect{a} \in \cartpwr{(A \union \sete{\off})}{s}}, \mathmode{\vect{b} \in \cartpwr{(B \union \sete{\off})}{s}}, and \mathmode{\ityp{0}{\strct{A}, \vect{a}} = \ityp{0}{\strct{B}, \vect{b}}}}
\]
and show that it has the back and forth properties. In proving the forth property, for example, suppose that $\vect{a} \mapsto \vect{b}$ is an $s$-partial isomorphism from $\strct{A}$ to $\strct{B}$ where $\vect{a}$ and $\vect{b}$ can be assumed to consist of distinct elements and $a$ is not an entry of $\vect{a}$, to show there is a $b$ (that is different from all entries in $\vect{b}$) such that, say, $\vect{a}\sbst{a}{i} \mapsto \vect{b}\sbst{b}{i}$ is an $s$-partial isomorphism, there are two cases to consider:
\begin{enumerate}[(1)]
%%
\item If $a_i = \off$ (\emph{extension} case), then we argue as for usual partial isomorphisms.
%%
\item If $a_i \neq \off$ (\emph{substitution} case), then observe that $\vect{a}' \mapsto \vect{b}'$ is also an $s$-partial isomorphism where $\vect{a}'$ and $\vect{b}'$ are $\vect{a}$ and $\vect{b}$ with $a_i$ and $b_i$ removed, respectively. We then reduce this to the above extension case.
%%
\end{enumerate}
Since $\tau$ is relational, we have $\off\etc\off \mapsto \off\etc\off \in I$ and hence $I \neq \emptyset$.

Finally, observe for $s \geq 1$, we have $\randstrtheory \consq \conjextaxm{s}$, thus $\conjextaxm{s}$ is satisfiable (since $\randstrtheory$ has a model). With the third statement in the book, it also implies that for any $\inflog[\omega]$-sentence $\varphi$, $\randstrtheory \consq \varphi$ or $\randstrtheory \consq \neg\varphi$.
%
\item \header{Note on 3.3.13} See Note on Example 2.3.5 on how to extend the result to arbitrary $\tau$.
%
\item \header{Hint to 3.3.14} In part (a), note that for $s, m \in \nat$, the set
\[
\sett{\ityp{m}{\strct{A}, \vect{a}}}{\mathmode{\strct{A}} a structure and \mathmode{\vect{a} \in \cartpwr{A}{s}}}
\]
is finite.
%
\end{enumerate}
%end of section 3-----------------------------------------------------------------------------